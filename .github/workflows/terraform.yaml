name: terraform
on: 
    workflow_dispatch: 
        inputs:
            mattias-input:
                description: 'This is a description, a bad one.'
                default: 'Spr√•k'
                required: false
                type: string
            karol-input:
                type: choice
                options:
                    - Val1
                    - Val2
                    - Val3
                default: 'Val2'
                required: false
    push:
        branches: main
env:
    mattias-env: dev
permissions: 
    contents: write
    id-token: write
    actions: write
defaults:
    run:
        shell: pwsh
jobs:
    terraform-plan: 
        name: terraformplan
        runs-on: ubuntu-latest
        environment: ${{ matrix.environment }}
        defaults:
            run:
                working-directory: ${{github.workspace}}
        strategy:
            matrix:
                environment: 
                    - dev
                    - prod
        steps:
            - name: mybiggeststep
              run: |
                    write-host 'Testing testing ${{ inputs.mattias-input }}'
                    write-host '${{inputs.karol-input}}'
    terraform-trigger:
        name: terraformtrigger
        uses: microbroke/micro-dev/.github/workflows/trigger.yaml